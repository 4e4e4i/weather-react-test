(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,n){e.exports=n(46)},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),i=n.n(c),o=n(11),u=n(47),l=n(48),s=n(49),f=n(6),p=n(9),m=n(12),h=n(10),E=n(13),d=(n(37),function(){return a.a.createElement("div",{className:"error-indicator"},a.a.createElement("span",null,"something has gone terribly wrong"))}),y=(n(38),function(){return a.a.createElement("div",{className:"spinner"},a.a.createElement("span",null,"Spinner!"))}),b=(n(39),function(e){var t=e.city,n=e.onDelete,r=t.id,c=t.name,i=t.main,o=t.sys,u=t.wind;return a.a.createElement("div",{className:"cities-list-item"},a.a.createElement("strong",{className:"cities-list-item__name"},a.a.createElement("span",null,c,","),a.a.createElement("span",null,o.country)),a.a.createElement("button",{onClick:function(){return n(r)},type:"button",className:"cities-list-item__btn btn btn-primary"},"Delete"),a.a.createElement("ul",{className:"cities-list-item__info"},a.a.createElement("li",null,a.a.createElement("span",null,"current temp: ",i.temp," C")),a.a.createElement("li",null,a.a.createElement("span",null,"current pressure: ",i.pressure)),a.a.createElement("li",null,a.a.createElement("span",null,"current wind speed: ",u.speed))))}),g=function(e){return localStorage.removeItem("cities-"+e),{type:"CITY_DELETED",payload:e}},v=function(e){return function(t){return function(n){e.addCity(t).then(function(e){return n({type:"CITY_ADDED",payload:e})}).catch(function(e){return n({type:"CITY_NOT_FOUND",payload:e})})}}},C=function(e){return function(){return function(t){t({type:"FETCH_CITIES_REQUESTED"}),e.getCurrent(),e.fetchCities().then(function(e){return t({type:"FETCH_CITIES_SUCCESS",payload:e})}).catch(function(e){return t({type:"FETCH_CITIES_FAILURE",payload:e})})}}},O=n(5),_=a.a.createContext(),j=_.Provider,S=_.Consumer,I=function(){return function(e){return function(t){return a.a.createElement(S,null,function(n){return a.a.createElement(e,Object.assign({},t,{weatherService:n}))})}}},w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}},T=(n(40),function(e){var t=e.cities,n=e.onDelete;if(t)return a.a.createElement("ul",{className:"cities-list"},t.map(function(e){return a.a.createElement("li",{key:e.id},a.a.createElement(b,{city:e,onDelete:n}))}))}),D=function(e){function t(){return Object(f.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchCities()}},{key:"render",value:function(){var e=this.props,t=e.cities,n=e.loading,r=e.error,c=e.onDelete;return n?a.a.createElement(y,null):r?a.a.createElement(d,null):a.a.createElement(T,{cities:t,onDelete:c})}}]),t}(r.Component),k=w(I(),Object(o.b)(function(e){return{cities:e.cities,loading:e.loading,error:e.error}},function(e,t){var n=t.weatherService;return Object(O.b)({fetchCities:C(n),onDelete:g},e)}))(D),x=(n(41),function(e){function t(){var e,n;Object(f.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).state={value:"",error:null},n.handleChange=function(e){n.setState({value:e.target.value})},n.handleClick=function(e){e.preventDefault(),n.props.onAddedToList(n.state.value),n.setState({value:""})},n}return Object(E.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.cityError;return a.a.createElement("form",{className:e?"city-form city-form--error":"city-form"},e?a.a.createElement("span",null,"Can't found city"):"",a.a.createElement("input",{className:"city-form__input",placeholder:"Enter your city",value:this.state.value,onChange:this.handleChange,type:"text"}),a.a.createElement("button",{className:"city-form__btn btn btn-primary",onClick:this.handleClick},"Add city"))}}]),t}(r.Component)),N=w(I(),Object(o.b)(function(e){return{cityError:e.cityError}},function(e,t){var n=t.weatherService;return Object(O.b)({onAddedToList:v(n)},e)}))(x),A=function(){return a.a.createElement("section",{className:"current-weather"},a.a.createElement("h1",null,"React Weather"),a.a.createElement(N,null),a.a.createElement(k,null))},F=(n(42),function(){return a.a.createElement("main",{role:"main",className:"container"},a.a.createElement(l.a,null,a.a.createElement(s.a,{path:"/",exact:!0,component:A})))}),P=function(e){function t(){var e,n;Object(f.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).state={hasError:!1},n}return Object(E.a)(t,e),Object(p.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?a.a.createElement(d,null):this.props.children}}]),t}(r.Component),R=n(8),U=n.n(R),B=n(16),H=n(17),L=n(7),Y={cities:[],loading:!0,error:null,cityError:null},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_CITIES_REQUESTED":return Object(L.a)({},e);case"FETCH_CITIES_SUCCESS":return Object(L.a)({},e,{cities:t.payload,loading:!1});case"FETCH_CITIES_FAILURE":return Object(L.a)({},e,{loading:!1,error:t.payload});case"CITY_ADDED":var n=t.payload,r=n.id;return-1===e.cities.findIndex(function(e){return e.id===r})?Object(L.a)({},e,{cities:[].concat(Object(H.a)(e.cities),[n]),loading:!1,cityError:!1}):Object(L.a)({},e);case"CITY_DELETED":var a=e.cities.findIndex(function(e){return e.id===t.payload});return Object(L.a)({},e,{cities:[].concat(Object(H.a)(e.cities.slice(0,a)),Object(H.a)(e.cities.slice(a+1)))});case"CITY_NOT_FOUND":return Object(L.a)({},e,{cityError:!0});default:return e}},M=n(26),K=Object(O.c)(J,Object(O.a)(M.a,function(){return function(e){return function(t){return e("string"===typeof t?{type:t}:t)}}},function(e){var t=e.getState;return function(e){return function(n){return console.log(n.type,t()),e(n)}}})),G=new function e(){var t=this;Object(f.a)(this,e),this._apiBase="https://api.openweathermap.org/data/2.5/weather",this._apiKey="&APPID=54795f00a49de9d54e952c6a88995e7c",this._apiMetric="&units=metric",this._lsPrefix="cities-",this.getCurrent=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(t.getCityByGeo)},this.getCityByGeo=function(){var e=Object(B.a)(U.a.mark(function e(n){var r,a;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.coords.latitude,a=n.coords.longitude,e.next=4,fetch("".concat(t._apiBase,"?lat=").concat(r,"&lon=").concat(a).concat(t._apiKey).concat(t._apiMetric));case 4:e.sent.json().then(function(e){var n="".concat(t._lsPrefix)+e.id;localStorage.getItem(n)||localStorage.setItem(n,JSON.stringify(e))});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.fetchCities=function(){var e=[];if(localStorage.length)for(var n=0;n<localStorage.length;n++)-1!==localStorage.key(n).indexOf("".concat(t._lsPrefix))&&e.push(JSON.parse(localStorage.getItem(localStorage.key(n))));return new Promise(function(t){setTimeout(function(){t(e)},900)})},this.getResource=function(){var e=Object(B.a)(U.a.mark(function e(n){var r;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._apiBase,"?q=").concat(n).concat(t._apiKey).concat(t._apiMetric));case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(n)+", received ".concat(r.status));case 5:return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.addCity=function(){var e=Object(B.a)(U.a.mark(function e(n){var r,a;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.getResource(n);case 4:return r=e.sent,a="".concat(t._lsPrefix)+r.id,localStorage.getItem(a)||localStorage.setItem(a,JSON.stringify(r)),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()};i.a.render(a.a.createElement(o.a,{store:K},a.a.createElement(P,null,a.a.createElement(j,{value:G},a.a.createElement(u.a,null,a.a.createElement(F,null))))),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.c48d1e18.chunk.js.map